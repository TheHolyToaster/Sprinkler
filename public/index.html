<!DOCTYPE html>
<html>
<body>
<h1>Control Sprinkler Zones</h1>

<button onclick='reset()'> Reset </button>
<button onclick='cycle()'> Cycle </button>

<div id = "zones"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script> 

<!-- include socket.io client side script -->

<script>

function cycle(){
  console.log('send loop');
  socket.emit("loop");
};

function reset(){
  console.log('send reset');
  socket.emit("reset");
};

var socket = io();
function bind(){
  var INs = document.getElementsByTagName("input");
  Array.prototype.forEach.call(INs, function(z,i) {
      console.log(i + ': ' +z);
      z.addEventListener("change", function() {
      var zone = {id : i, value: (this.checked)}
      socket.emit("zone", zone );
    });
  });
};

socket.emit("length?");
socket.on('length!', function (data) {
  console.log("echo value" + data);
  var title = document.getElementById ("zones");
  console.log(title);
  var i;
  for (i = 0; i < data; i++) {
    title.innerHTML += '<p><input type="radio" name="zone" >Zone ' +(i+1)+ '</p>';
  }
  bind();

});

</script>
</html>
</body>
</html>